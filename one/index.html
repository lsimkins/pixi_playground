<!DOCTYPE HTML>
<html>
<head>
  <title>pixi.js example 1</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #000000;
    }
  </style>
  <script src="../../pixi.js/bin/pixi.dev.js"></script>

</head>
<body>
  <script>
  var stage = new PIXI.Stage(0x111111);
  var renderer = PIXI.autoDetectRenderer(400, 300);
  document.body.appendChild(renderer.view);

  requestAnimFrame(animate);

  // Create main comet.
  var mainTexture = PIXI.Texture.fromImage("comet5.png");

  var comet = new PIXI.Sprite(mainTexture);
  comet.anchor.x = comet.anchor.y = 0.5;
  comet.position.x = 200;
  comet.position.y = 150;
  comet.scale.x = comet.scale.y = 0.6;
  comet.rotation = Math.PI / 2;

  stage.addChild(comet);

  // Create dust textures.
  var dustTexture = PIXI.Texture.fromImage("comet4.png");
  var dustSprites = [];

  var shake = -3;

  function animate() {
      requestAnimFrame(animate);

      shake *= -1;
      comet.position.x += shake;

      renderer.render(stage);

      if (Math.random() < 0.2) {
        addDust();
      }

      for (var i = dustSprites.length - 1; i >= 0; i--) {
        //dustSprites[i].position.x -= 1.5;
        dustSprites[i].position.y += 2;
        dustSprites[i].rotation += 0.1;

        if (dustSprites[i].alpha < dustSprites[i].alphaTo) {
          dustSprites[i].alpha += 0.02;
        }
      }

      comet.rotation += 0.003;
  }

  function addDust() {
    var dust = new PIXI.Sprite(dustTexture);
    dust.scale.x = dust.scale.y = 0.3 + (Math.random() * 0.6);
    dust.anchor.x = dust.anchor.y = 0.5 + (Math.random() * 0.1 - 0.05);

    dust.position.x = -100 * Math.random() + 50;
    dust.position.y = -100 * Math.random() - 30;

    dust.alpha = 0;
    dust.alphaTo = 0.3 + Math.random() * 0.3;

    // dustContainer.addChild(dust);
    comet.addChild(dust);

    dustSprites.push(dust);
  }
  </script>

  </body>
</html>
